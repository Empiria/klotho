---
phase: 09-refactor-klotho-kob
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/cli.rs
  - klotho
autonomous: true

must_haves:
  truths:
    - "CLI accepts --linked-dir flag that can be repeated multiple times"
    - "klotho --help shows --linked-dir with description about symlink resolution"
    - "Bash script no longer exists in repository"
  artifacts:
    - path: "src/cli.rs"
      provides: "linked_dirs Vec<String> field in Start command"
      contains: "linked_dirs"
  key_links:
    - from: "src/cli.rs"
      to: "Start command struct"
      via: "#[arg(long = \"linked-dir\")]"
      pattern: 'linked_dirs.*Vec<String>'
---

<objective>
Add the `--linked-dir` CLI flag to the Start command and delete the deprecated bash script.

Purpose: Prepare CLI interface for the new KLOTHO_LINKED_DIRS feature while removing the legacy bash implementation that is no longer canonical.
Output: CLI accepts repeatable `--linked-dir` flag; bash script deleted from repository.
</objective>

<execution_context>
@/home/owen/.claude/get-shit-done/workflows/execute-plan.md
@/home/owen/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/09-refactor-klotho-kob/09-CONTEXT.md
@.planning/phases/09-refactor-klotho-kob/09-RESEARCH.md

@src/cli.rs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add --linked-dir CLI flag to Start command</name>
  <files>src/cli.rs</files>
  <action>
Add `linked_dirs: Vec<String>` field to the Start variant in the Commands enum.

Use the following pattern from RESEARCH.md:
```rust
/// Directories to mount at same path for symlink resolution (repeatable)
#[arg(long = "linked-dir")]
linked_dirs: Vec<String>,
```

Place it after the `name` field and before the `paths` field in the Start struct.

The Vec<String> type with clap derive automatically creates a repeatable flag that collects all occurrences.
  </action>
  <verify>Run `cargo build` to confirm compilation succeeds. Run `cargo run -- start --help` and verify `--linked-dir` appears in the help output with the description about symlink resolution.</verify>
  <done>Start command accepts `--linked-dir <DIR>` flag that can be specified multiple times. Help text shows the flag with description.</done>
</task>

<task type="auto">
  <name>Task 2: Delete the deprecated bash script</name>
  <files>klotho</files>
  <action>
Delete the file `klotho` (the bash script) from the repository root.

This is the legacy bash implementation (~25KB) that was replaced by the Rust version in Phase 7. The Rust binary is now canonical and the bash script should not exist alongside it.

Use: `rm klotho`

The file is tracked in git, so also stage the deletion for the commit.
  </action>
  <verify>Run `ls -la klotho` and confirm the file no longer exists (command should fail). Run `git status` and confirm the deletion is staged or shows as deleted.</verify>
  <done>Bash script `klotho` no longer exists in the repository. Git shows the file as deleted.</done>
</task>

</tasks>

<verification>
1. `cargo build` succeeds without warnings
2. `cargo run -- start --help` shows `--linked-dir <DIR>` flag with description
3. `ls klotho` fails (file does not exist)
4. Running `cargo run -- start --linked-dir /tmp/test --linked-dir /tmp/test2 .` should parse without error (will fail at runtime since dirs don't exist, but CLI parsing works)
</verification>

<success_criteria>
- [ ] src/cli.rs contains `linked_dirs: Vec<String>` in Start command
- [ ] --linked-dir flag documented in help text
- [ ] Bash script `klotho` deleted from repository
- [ ] cargo build succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/09-refactor-klotho-kob/09-01-SUMMARY.md`
</output>
