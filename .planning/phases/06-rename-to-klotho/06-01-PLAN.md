---
phase: 06-rename-to-klotho
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - klotho
  - agent-session
autonomous: true

must_haves:
  truths:
    - "User can run 'klotho start' to create sessions"
    - "User can run 'agent-session start' via symlink (backward compatibility)"
    - "Help text shows 'klotho' as the command name"
  artifacts:
    - path: "klotho"
      provides: "Main CLI script with updated name and references"
      min_lines: 700
    - path: "agent-session"
      provides: "Backward compatibility symlink"
      type: symlink
  key_links:
    - from: "agent-session"
      to: "klotho"
      via: "symbolic link"
      pattern: "symlink"
---

<objective>
Rename the main CLI script from `agent-session` to `klotho` and update all internal references.

Purpose: Establish the new project identity while maintaining backward compatibility for existing users.
Output: Renamed CLI script with updated help text, error messages, and XDG config paths. Symlink for backward compatibility.
</objective>

<execution_context>
@/home/owen/.claude/get-shit-done/workflows/execute-plan.md
@/home/owen/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-rename-to-klotho/06-RESEARCH.md
@agent-session
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rename script and update all internal references</name>
  <files>klotho</files>
  <action>
1. Rename the script file:
   ```bash
   git mv agent-session klotho
   ```

2. Update all help text in klotho to use new command name:
   - "Usage: agent-session" -> "Usage: klotho"
   - "Run 'agent-session" -> "Run 'klotho"
   - "agent-session start" -> "klotho start"
   - "agent-session ls" -> "klotho ls"
   - "agent-session stop" -> "klotho stop"
   - "agent-session restart" -> "klotho restart"
   - "agent-session rm" -> "klotho rm"

3. Update image name references:
   - "agent-session-${agent}:latest" -> "klotho-${agent}:latest"
   - "agent-session-${AGENT_TYPE}:latest" -> "klotho-${AGENT_TYPE}:latest"

4. Update XDG config path in load_agent_config() to check both locations:
   ```bash
   # Check new location first, fall back to old
   local new_config="$config_home/klotho/agents/$agent/config.conf"
   local old_config="$config_home/agent-session/agents/$agent/config.conf"

   if [[ -f "$new_config" ]]; then
       source "$new_config"
   elif [[ -f "$old_config" ]]; then
       echo "warning: using deprecated config path: $old_config" >&2
       echo "please move config to: $new_config" >&2
       source "$old_config"
   fi
   ```

5. Update environment variable support to check both names:
   - Check KLOTHO_MOUNTS first, fall back to AGENT_SESSION_MOUNTS
   - Check KLOTHO_KOB first, fall back to AGENT_SESSION_KOB

Do NOT update container name pattern detection yet - that's in Plan 02.
  </action>
  <verify>
Run `./klotho --help` and verify:
- Usage line shows "klotho" not "agent-session"
- All examples show "klotho" command
- No "agent-session" appears in help text
  </verify>
  <done>Script renamed to klotho with all internal references updated. Help text shows klotho throughout.</done>
</task>

<task type="auto">
  <name>Task 2: Create backward compatibility symlink</name>
  <files>agent-session</files>
  <action>
Create symlink from old name to new:
```bash
ln -s klotho agent-session
```

This allows users with muscle memory or existing scripts to continue using `agent-session` command.
  </action>
  <verify>
```bash
ls -la agent-session  # Should show: agent-session -> klotho
./agent-session --help  # Should show klotho help (via symlink)
```
  </verify>
  <done>Symlink created. Both `./klotho` and `./agent-session` work identically.</done>
</task>

</tasks>

<verification>
- [ ] `./klotho --help` shows updated help with "klotho" throughout
- [ ] `./klotho start --help` shows "klotho" in usage
- [ ] `./agent-session --help` works via symlink
- [ ] No "agent-session" text remains in klotho script help/error messages (except in backward compat comments)
- [ ] XDG config path check tries ~/.config/klotho first
</verification>

<success_criteria>
- klotho script exists with all internal "agent-session" references updated
- agent-session symlink points to klotho
- Both commands produce identical output
- Help text consistently shows "klotho" as the command name
</success_criteria>

<output>
After completion, create `.planning/phases/06-rename-to-klotho/06-01-SUMMARY.md`
</output>
